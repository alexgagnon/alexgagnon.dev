--- 
import { FUIEmailAddress } from '@ferment-ui/web-components';
import { createIcons, ExternalLink } from 'lucide';

interface Props {
	title: string;
}

const { title } = Astro.props;

const pages = [
  {
    title: 'About',
    href: '/about',
  },
  {
    title: 'Resumé',
    href: '/resume',
  }
];

const pathname = new URL(Astro.request.url).pathname;
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Alex Gagnon | {title}</title>
		<meta name="viewport" content="width=device-width" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="description" content="Personal site for Alex Gagnon">
    <style is:global>
      @font-face {
        font-family: 'Handjet';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/l/font?kit=oY1n8eXHq7n1OnbQrOY_2FrEwYEMLlcdP1mCtZaLaTutCwcIhGZ0lGU0akFcO3XFHTmaUkA0AElwNVJxzsVdN-7pJIJXYhHI3yIY&skey=4a9faa4e98ec440b&v=v19) format('woff2');
      }

      @font-face {
        font-family: 'Bricolage Grotesque';
        font-style: normal;
        font-weight: 400;
        font-stretch: 100%;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/bricolagegrotesque/v1/3y9U6as8bTXq_nANBjzKo3IeZx8z6up5BeSl5jBNz_19PpbpMXuECpwUxJBOm_OJWiaaD30YfKfjZZoLvRvi-Molsg.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }

      @font-face {
        font-family: 'Playfair Display';
        font-style: italic;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/playfairdisplay/v36/nuFRD-vYSZviVYUb_rj3ij__anPXDTnCjmHKM4nYO7KN_qiTXtHA-Q.woff2) format('woff2');
      }
    </style>
		<meta name="generator" content={Astro.generator} />
    <slot name='styles'></slot>
	</head>
	<body>
    <a href='#main' class='v-on-pin a-center'>Skip to main content</a>
    <header role="banner">
      <div class="a-end ai-center mt mb"><FUIEmailAddress label="Say hi" user="xela" domain="aidem.danom" /><a href="https://github.com/alexgagnon"><i data-lucide="github" class='tappable'></i><span class="sr-only">Github</span></a></div>
      <nav>
        <ul>
          <li id="logo"><a href="/" class:list={['fs-h2', 'ff-display', {'active': '/' === pathname}]}>Alex Gagnon</a></li>
          <li id="menu">
            <button id="menu-toggle" class="tt-uppercase tappable" aria-haspopup="true" aria-expanded="false">Menu</button>
            <ul id="menu-items">
              {pages.map(({title, href}) => <li><a href={href} class:list={['tappable', {'active': href === pathname}]}>{title}</a></li>)}
            </ul>
          </li>
        </ul>
      </nav>
    </header>
    <main id="main" class="page">
      <slot />
    </main>
    <footer>
      <p class='fs-h5'>© {new Date().getFullYear()} | Alex Gagnon</p>
    </footer>
	</body>
</html>

<script>
  import {computePosition, shift} from "@floating-ui/dom";
  import {createIcons, ExternalLink, Github} from 'lucide';

  // const fonts = [
  //   new FontFace('Albert Sans', 'url(/assets/fonts/AlbertSans-Regular-subset.woff2) format("woff2")', {style: 'normal', weight: '400'}),
  // ];

  // document.fonts.add(...fonts);

  // Promise.all(fonts.map(font => font.load()))
  //   .then(() => {
  //     document.documentElement.classList.add('fonts-loaded');
  //   })
  //   .catch(console.error);

  const menuToggle = document.getElementById('menu-toggle');
  const menuItems = document.getElementById('menu-items');

  menuToggle.addEventListener('click', () => {
    const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
    menuToggle.setAttribute('aria-expanded', !isExpanded);
    update();
  });

  function update() {
    computePosition(menuToggle, menuItems, {
      placement: 'bottom-end',
      middleware: [
        shift(),
      ]
    }).then(({x, y}) => {
      menuItems.style.left = `${x}px`,
      menuItems.style.top = `${y}px`
    });
  }
    
  createIcons({
    icons: {
      ExternalLink,
      Github
    }
  })
</script>

<style>
  body {
    min-height: 100vh;
    min-height: 100dvh;
    display: grid;
    grid-template-areas:
      "header"
      "main"
      "footer";
    grid-template-rows: auto 1fr auto;
    font-family: var(--font-family-body);
  }

  [role="banner"] {
    grid-area: header;
    width: 100%;
    padding: 0 1rem;
  }

  [role="banner"] ul {
    display: flex;
    align-items: stretch;
  }

  [role="banner"] nav {
    width: 100%;
  }

  [role="banner"] a {
    text-decoration: none;
    padding: 0 2rem;
  }

  #logo {
    grid-area: logo;
    margin-right: auto;
  }

  #menu {
    grid-area: menu;
    display: flex;
    position: relative;
  }

  #menu li {
    display: flex;
    align-items: stretch;
  }

  #menu a {
    display: flex;
    align-items: center;
    text-transform: uppercase;
  }

  #menu-items {
    display: none;
    width: max-content;
    position: absolute;
    border: 1px solid currentColor;
  }

  #menu-toggle[aria-expanded=true] + #menu-items {
    display: flex;
    flex-direction: column;
  }

  @media (min-width: 768px) {
    #menu-toggle {
      display: none;
    }

    #menu-items {
      display: flex;
      flex-direction: row !important;
      position: static;
      border: 0;
      
    }
  }

  a.active {
    /* border-bottom: 2px solid currentColor; */
  }
</style>

<style is:global>
  :root {
    --spacing-base: 1rem;
    --spacing-responsive: clamp(var(--spacing-base), 5%, 4rem);
    --font-scale: 1.2;
    --font-scale-start: 1rem;
    --font-size-h6: var(--font-scale-start);
    --font-size-h5: calc(var(--font-scale) * var(--font-size-h6));
    --font-size-h4: calc(var(--font-scale) * var(--font-size-h5));
    --font-size-h3: calc(var(--font-scale) * var(--font-size-h4));
    --font-size-h2: calc(var(--font-scale) * var(--font-size-h3));
    --font-size-h1: calc(var(--font-scale) * var(--font-size-h2));
    --font-family-body: 'Bricolage Grotesque', sans-serif;
    --font-family-heading: 'Playfair Display', serif;
    --font-family-display: 'Handjet', serif;
    --br: 4px;
    --border: 2px solid currentColor;
    --S-card: var(--spacing-responsive);
  }

  @media (min-width: 768px) {
    :root {
      --font-scale: 1.33;
    }
  }

  * {
    box-sizing: border-box;
    padding: 0;
    margin: 0;
  }

  *:focus {
    outline: 2px dashed currentColor;
  }

  .funtimes-on-pin:hover,
  .funtimes-on-pin:focus {
    background: rgb(131,58,180);
    background: linear-gradient(56deg, rgba(131,58,180,1) 0%, rgba(253,29,29,1) 50%, rgba(252,176,69,1) 100%);
    color: white;
  }

  [class*="-on-"] {
    transition: 0.2s ease-in-out;
  }

  .tappable {
    cursor: pointer;
    min-height: 44px;
    min-width: 44px;
  }

  body {
    line-height: 1.8;
  }

  ul {
    list-style-type: none;
    list-style-position: inside;
  }

  .lst-none {
    list-style-type: none;
  }

  .lst-disc {
    list-style-type: disc;
  }

  h1, .h1, h2, .h2, h3, .h3, h4, .h4, h5, .h5, h6, .h6 {
    font-family: var(--font-family-heading);
  }

  h1, .h1 {
    font-size: var(--font-size-h1);
  }

  h2, .h2 {
    font-size: var(--font-size-h2);
  }

  h3, .h3 {
    font-size: var(--font-size-h3);
  }

  h4, .h4 {
    font-size: var(--font-size-h4);
  }

  h5, .h5 {
    font-size: var(--font-size-h5);
  }

  h6, .h6 {
    font-size: var(--font-size-h6);
  }

  .ff-body {
    font-family: var(--font-family-body);
  }

  .ff-display {
    font-family: var(--font-family-display);
  }

  .subheading {
    font-size: var(--font-size-h5);
    font-weight: 700;
  }

  .fs-body {
    font-size: var(--font-size-body);
  }

  .fs-h1 {
    font-size: var(--font-size-h1);
  }

  .fs-h2 {
    font-size: var(--font-size-h2);
  }

  .fs-h3 {
    font-size: var(--font-size-h3);
  }

  .fs-h4 {
    font-size: var(--font-size-h4);
  }

  .fs-h5 {
    font-size: var(--font-size-h5);
  }

  .fs-h6 {
    font-size: var(--font-size-h6);
  }

  .tt-uppercase {
    text-transform: uppercase;
  }

  h1 + p, .h1 + p, h2 + p, .h2 + p, h3 + p, .h3 + p, h4 + p, .h4 + p, h5 + p, .h5 + p, h6 + p, .h6 + p, p + * {
    margin-top: var(--spacing-base);
  }

  .a-row {
    flex-direction: row;
  }

  .a-column {
    flex-direction: column;
  }

  .a-start {
    display: flex;
    justify-content: flex-start;
  } 

  .a-end {
    display: flex;
    justify-content: flex-end;
  }

  .a-center {
    display: flex;
    justify-content: center;
  }

  .ai-center {
    align-items: center;
  }

  .jc-center {
    justify-content: center;
  }

  .l-start {
    display: grid;
    place-content: start;
  }

  .l-end {
    display: grid;
    place-content: end;
  }

  .l-center {
    display: grid;
    place-content: center;
    height: 100%;
  }

  .g {
    gap: var(--spacing-base);
  }

  .g-responsive {
    gap: var(--spacing-responsive);
  }

  .m {
    margin: var(--spacing-base);
  }

  .mt-responsive {
    margin-top: var(--spacing-responsive);
  }

  .mt {
    margin-top: var(--spacing-base);
  }

  .mb-responsive {
    margin-bottom: var(--spacing-responsive);
  }

  .mb {
    margin-bottom: var(--spacing-base);
  }

  .static {
    position: static;
  }

  .relative {
    position: relative;
  }

  .absolute {
    position: absolute;
  }

  .block {
    display: block;
  }

  .inline-block {
    display: inline-block;
  }

  .inline {
    display: inline;
  }

  .none {
    display: none
  }

  .flex {
    display: flex;
  }

  .fd-column {
    flex-direction: column;
  }

  .fd-row {
    flex-direction: row;
  }

  .page {
    max-width: 65rem;
    padding: 1.5rem clamp(1rem, 5%, 3rem);
    margin: 0 auto;
  }

  main {
    grid-area: main;
    display: flex;
    flex-direction: column;
    justify-content: stretch;
  }

  footer {
    grid-area: footer;
  }

  a {
    color: inherit;
  }

  .lucide-external-link {
    margin-left: 0.5rem;
    padding-top: 0.2rem;
  }

  button, .btn {
    display: inline-block;
    padding: 1rem 2rem;
    border: var(--border);
    text-decoration: none;
  }

  .float-on-pin:hover,
  .float-on-pin:focus {
    box-shadow: 0 4px 4px 2px currentColor;
    transform: translateY(-4px);
  }

  .v-on-pin {
    position: absolute;
    top: -100vh;
    width: 100%;
  }

  .v-on-pin:focus,
  .v-on-pin:hover {
    top: 0;
  }

  .sr-only	{
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  .not-sr-only	{
    position: static;
    width: auto;
    height: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }

  .fancy-button {
    border: 2px solid black;
    background: rgb(131,58,180);
    background: linear-gradient(56deg, rgba(131,58,180,1) 0%, rgba(253,29,29,1) 50%, rgba(252,176,69,1) 100%);
    text-decoration: none;
    padding: 0.5rem 1rem;
    transition: 0.2s ease-in-out;
  }

  .fancy-button:hover,
  .fancy-button:focus {
    background: linear-gradient(56deg, white 0%, white 100%);
  }
</style>
